<!doctype html><html lang="ar" dir="rtl"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>لوحة الإدارة</title>
<link rel="stylesheet" href="style.css"/>
</head><body>

<header>
  <div class="container header-inner">
    <div class="brand">
      <img src="logo.png" alt="شعار الأصالة" />
      <div class="title">كليات الأصالة – كلية القانون</div>
    </div>
    <nav>
      <a href="index.html">الرئيسية</a>
      <a href="instructions.html">تعليمات سريعة</a>
      <a href="contact.html">تواصل مع الإدارة</a>
      <a href="login.html">دخول أعضاء هيئة التدريس</a>
      <a href="admin.html">الإدارة</a>
    </nav>
  </div>
</header>


<main class="container">
  <h2>لوحة الإدارة</h2>
  <div id="gate" class="card" style="display:none">
    <h3>تسجيل دخول الإدارة</h3>
    <label>اسم المستخدم</label><input id="au" placeholder="admin">
    <label>كلمة المرور</label><input id="ap" type="password" placeholder="••••••••">
    <div class="actions">
      <button class="btn" onclick="adminLogin()">دخول</button>
      <a class="btn outline" href="index.html">الرئيسية</a>
    </div>
    <div id="amsg" class="warning" style="display:none"></div>
  </div>

  <div id="content" style="display:none">
    <div class="card">
      <h3>الوارد من نموذج التواصل</h3>
      <div id="inboxWrap"></div>
      <div class="actions">
        <button class="btn outline" onclick="toggleGuard()">تفعيل/إيقاف Exam Access Guard</button>
        <a class="btn" href="guard.html" target="_blank">فتح شاشة QR</a>
      </div>
      <div class="notice" id="guardState"></div>
    </div>
  </div>
</main>

<footer class="footer">تم تطوير المنصة بواسطة د. محمد الشمراني – 2025 · جميع الحقوق محفوظة</footer><!-- Secure Quiz Asala v3.9 (2025) – added Exam Access Guard (feature-flagged; default OFF) -->

<script>
const ADMIN={user:'admin', pass:'AaBbCc123'};
const me = JSON.parse(localStorage.getItem('currentUser')||'null');
function renderInbox(){
  const inbox = JSON.parse(localStorage.getItem('adminInbox')||'[]');
  const wrap = document.getElementById('inboxWrap');
  if(inbox.length===0){ wrap.innerHTML='<div class="notice">لا توجد رسائل</div>'; return; }
  let html='<table class="table"><tr><th>التاريخ</th><th>المرسل</th><th>البريد</th><th>الموضوع</th><th>الرسالة</th></tr>';
  inbox.forEach(m=>{ html += `<tr><td>${new Date(m.ts).toLocaleString('ar-SA')}</td><td>${m.name}</td><td>${m.email}</td><td>${m.subject}</td><td style="text-align:right">${m.body}</td></tr>`; });
  html+='</table>'; wrap.innerHTML=html;
}
function adminLogin(){
  if(au.value.trim()===ADMIN.user && ap.value===ADMIN.pass){
    localStorage.setItem('currentUser', JSON.stringify({username:'admin', role:'admin'}));
    document.getElementById('gate').style.display='none'; document.getElementById('content').style.display='block';
    renderInbox(); syncGuardState();
  }else{ amsg.style.display='block'; amsg.innerText='بيانات الدخول غير صحيحة'; }
}
if(!me || me.role!=='admin'){ document.getElementById('gate').style.display='block'; }
else { document.getElementById('content').style.display='block'; renderInbox(); syncGuardState(); }
function toggleGuard(){ const on = localStorage.getItem('examGuardOn')==='1'; localStorage.setItem('examGuardOn', on?'0':'1'); syncGuardState(); alert('Exam Access Guard: ' + (on?'OFF':'ON')); }
function syncGuardState(){ const on = localStorage.getItem('examGuardOn')==='1'; guardState.innerHTML = 'Exam Access Guard: <b>' + (on?'مفعّل':'متوقف') + '</b> (افتراضيًا متوقف)'; }
</script>

</body></html>