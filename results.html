<!doctype html>
<html lang="ar" dir="rtl"><head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>نتائج الطلاب</title>
  <link rel="stylesheet" href="style.css"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  
<header>
  <div class="container header-inner">
    <div class="brand">
      <img src="logo.png" alt="شعار الأصالة" />
      <div class="title">كليات الأصالة – كلية القانون</div>
    </div>
    <nav>
      <a href="index.html">الرئيسية</a>
      <a href="instructions.html">تعليمات سريعة</a>
      <a href="contact.html">تواصل مع الإدارة</a>
      <a href="login.html">دخول أعضاء هيئة التدريس</a>
    </nav>
  </div>
</header>

  <main class="container">
    <h2>نتائج الطلاب</h2>
    <p>هذه الصفحة تعرض نتائج الاختبارات المخزنة محليًا (تجريبية). عند استخدام منصة الإنشاء الفعلية يمكن الربط لاحقًا بقاعدة البيانات.</p>
    <div id="wrap"></div>
  </main>
  
<footer class="footer">
  تم تطوير المنصة بواسطة د. محمد الشمراني
</footer>

  <script>
    const data = JSON.parse(localStorage.getItem('studentResults')||'[]');
    const wrap = document.getElementById('wrap');
    if(data.length===0) {
      wrap.innerHTML='<div class="notice">لا توجد نتائج حتى الآن.</div>';
    } else {
      data.forEach((r,i)=>{
        const card = document.createElement('div'); card.className='card';
        card.innerHTML = `
          <h3>الطالب: ${r.student.name} – الرقم: ${r.student.id}</h3>
          <div>الاختبار: ${r.quizTitle} | الدرجة: <b>${r.score}%</b></div>
          <canvas id="chart${i}" height="120"></canvas>
          <div class="notice">ملاحظة للطالب: يرجى التقاط صورة للشاشة وإرسالها لمدرّس المقرر قبل إغلاق النافذة.</div>
        `;
        wrap.appendChild(card);
        const ctx = card.querySelector('canvas').getContext('2d');
        new Chart(ctx, {
          type:'bar',
          data:{labels:['صحيحة','خاطئة'], datasets:[{label:'عدد الأسئلة', data:[r.correct,r.total-r.correct]}]},
          options:{responsive:true, plugins:{legend:{display:false}}}
        });
      });
    }
  </script>
</body></html>
